<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Example 4: Winner Announcement - Showdown & Winner</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
            background-color: #2c5530;
            color: white;
        }
        .container {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        h1 { color: #2c5530; margin-top: 0; }
        .card-display {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .card {
            background: white;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 24px;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        .card.hearts, .card.diamonds { color: #d32f2f; }
        .card.clubs, .card.spades { color: #000; }
        
        .winner-announcement {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
            box-shadow: 0 8px 16px rgba(255, 215, 0, 0.5);
            animation: winnerGlow 2s infinite;
        }
        
        @keyframes winnerGlow {
            0%, 100% { box-shadow: 0 8px 16px rgba(255, 215, 0, 0.5); }
            50% { box-shadow: 0 8px 32px rgba(255, 215, 0, 0.8); }
        }
        
        .winner-text {
            font-size: 36px;
            font-weight: bold;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin: 20px 0;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .hand-description {
            font-size: 24px;
            color: #fff;
            font-weight: bold;
            margin: 15px 0;
        }
        
        .pot-amount {
            font-size: 28px;
            color: #fff;
            font-weight: bold;
            margin: 15px 0;
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #FFD700;
            position: absolute;
            animation: confettiFall 3s linear;
        }
        
        @keyframes confettiFall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .player-card {
            background: #f5f5f5;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border: 2px solid #ddd;
        }
        
        .player-card.winner {
            border: 4px solid #FFD700;
            background: #fffef5;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            animation: winnerPulse 2s infinite;
        }
        
        @keyframes winnerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .player-name {
            font-size: 22px;
            font-weight: bold;
            color: #2c5530;
        }
        
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 14px 28px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        button:hover { background: #45a049; }
        .output {
            margin-top: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 5px;
        }
        .debug {
            font-family: monospace;
            background: #1e1e1e;
            color: #4ec9b0;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Example 4: Winner Announcement</h1>
        <p>This example demonstrates dramatic winner reveals with animations, descriptive hand names, and celebration effects.</p>
        
        <button onclick="testCase1()">Test Case 1 (Single Winner)</button>
        <button onclick="testCase2()">Test Case 2 (Split Pot)</button>
        <button onclick="runExample()">Test Case 3 (All Fold)</button>
        
        <div id="output" class="output">
            <h3>Click a test case to see winner announcement...</h3>
        </div>
        
        <div id="debug" class="debug"></div>
    </div>

    <script>
        /*
         * WINNER ANNOUNCEMENT EXAMPLE
         * Demonstrates dramatic winner reveals with animations and effects
         * Includes descriptive hand names and celebration animations
         */
        
        console.log('Example 4: Winner Announcement');
        console.log('Lesson: Showdown & Winner Determination');
        
        function getSuitSymbol(suit) {
            const symbols = { hearts: "‚ô•", diamonds: "‚ô¶", clubs: "‚ô£", spades: "‚ô†" };
            return symbols[suit] || suit;
        }

        function createCard(rank, suit, value) {
            return { rank, suit, value };
        }

        function createPlayer(name, chips, hand, folded = false) {
            return { name, chips, hand, folded, handRank: null };
        }

        // Evaluate hand with descriptive name
        function evaluateHand(cards) {
            const sorted = [...cards].sort((a, b) => b.value - a.value);
            const groups = {};
            sorted.forEach(card => {
                if (!groups[card.value]) groups[card.value] = [];
                groups[card.value].push(card);
            });
            
            // Group by count for easier evaluation
            const groupsByCount = Object.entries(groups).sort((a, b) => {
                const countDiff = b[1].length - a[1].length;
                if (countDiff !== 0) return countDiff;
                return Number(b[0]) - Number(a[0]); // Sort by value if counts are equal
            });
            
            const counts = groupsByCount.map(g => g[1].length);
            const values = groupsByCount.map(g => Number(g[0]));
            
            // Get descriptive name
            let description = "";
            
            if (counts[0] === 4) {
                const rankName = getRankName(values[0]);
                description = `Four ${rankName}s`;
                return { rank: 7, name: "Four of a Kind", description };
            }
            if (counts[0] === 3 && counts[1] === 2) {
                const tripleRank = getRankName(values[0]);
                const pairRank = getRankName(values[1]);
                description = `Full House, ${tripleRank}s over ${pairRank}s`;
                return { rank: 6, name: "Full House", description };
            }
            if (counts[0] === 3) {
                const rankName = getRankName(values[0]);
                description = `Three ${rankName}s`;
                return { rank: 3, name: "Three of a Kind", description };
            }
            if (counts[0] === 2 && counts[1] === 2) {
                const highPair = getRankName(values[0]);
                const lowPair = getRankName(values[1]);
                description = `Two Pair, ${highPair}s and ${lowPair}s`;
                return { rank: 2, name: "Two Pair", description };
            }
            if (counts[0] === 2) {
                const rankName = getRankName(values[0]);
                description = `Pair of ${rankName}s`;
                return { rank: 1, name: "Pair", description };
            }
            
            const allValues = Object.keys(groups).map(Number).sort((a, b) => b - a);
            description = `${getRankName(allValues[0])}-high`;
            return { rank: 0, name: "High Card", description };
        }

        function getRankName(value) {
            const names = { 
                14: 'Ace', 13: 'King', 12: 'Queen', 11: 'Jack', 
                10: 'Ten', 9: 'Nine', 8: 'Eight', 7: 'Seven',
                6: 'Six', 5: 'Five', 4: 'Four', 3: 'Three', 2: 'Two'
            };
            return names[value] || value.toString();
        }

        function determineWinner(players) {
            const activePlayers = players.filter(p => !p.folded);
            
            if (activePlayers.length === 0) {
                return { type: 'no-winner', message: 'All players folded' };
            }
            
            if (activePlayers.length === 1) {
                return { 
                    type: 'fold-win', 
                    winner: activePlayers[0],
                    message: activePlayers[0].name + ' wins (all others folded)'
                };
            }
            
            // Evaluate hands
            activePlayers.forEach(player => {
                player.handRank = evaluateHand(player.hand);
            });
            
            // Find best hand
            const bestRank = Math.max(...activePlayers.map(p => p.handRank.rank));
            const winners = activePlayers.filter(p => p.handRank.rank === bestRank);
            
            if (winners.length === 1) {
                return {
                    type: 'single-winner',
                    winner: winners[0],
                    message: winners[0].name + ' wins with ' + winners[0].handRank.description
                };
            } else {
                return {
                    type: 'split-pot',
                    winners: winners,
                    message: 'Split pot between ' + winners.map(w => w.name).join(' and ')
                };
            }
        }

        function announceWinner(players, pot, result) {
            console.log("\n" + "=".repeat(60));
            console.log("WINNER ANNOUNCEMENT");
            console.log("=".repeat(60));
            console.log("Pot: $" + pot);
            console.log("Result: " + result.message);
            
            if (result.winner) {
                console.log("üèÜ WINNER: " + result.winner.name);
                if (result.winner.handRank) {
                    console.log("   Hand: " + result.winner.handRank.description);
                }
                console.log("   Winnings: $" + pot);
            } else if (result.winners) {
                const share = Math.floor(pot / result.winners.length);
                result.winners.forEach(winner => {
                    console.log("üèÜ WINNER: " + winner.name);
                    console.log("   Hand: " + winner.handRank.description);
                    console.log("   Winnings: $" + share);
                });
            }
            
            console.log("=".repeat(60));
        }

        function displayWinnerAnnouncement(players, pot, result) {
            const output = document.getElementById("output");
            let html = '';
            
            // Show all players first
            html += '<h3>Final Hands</h3>';
            players.forEach(player => {
                const isWinner = (result.winner === player) || 
                                (result.winners && result.winners.includes(player));
                html += `<div class="player-card ${isWinner ? 'winner' : ''}">`;
                html += `<div class="player-name">${player.name}</div>`;
                
                if (!player.folded) {
                    html += '<div class="card-display">';
                    player.hand.forEach(card => {
                        html += `<div class="card ${card.suit}">${card.rank}${getSuitSymbol(card.suit)}</div>`;
                    });
                    html += '</div>';
                    
                    if (player.handRank) {
                        html += `<div style="margin-top: 10px; font-weight: bold; color: #4CAF50;">${player.handRank.description}</div>`;
                    }
                } else {
                    html += '<div style="margin-top: 10px; color: #999; font-style: italic;">Folded</div>';
                }
                html += '</div>';
            });
            
            // Winner announcement
            if (result.type === 'single-winner') {
                html += '<div class="winner-announcement">';
                html += '<div class="winner-text">üèÜ WINNER üèÜ</div>';
                html += `<div class="hand-description">${result.winner.name}</div>`;
                html += `<div class="hand-description">${result.winner.handRank ? result.winner.handRank.description : 'All others folded'}</div>`;
                html += `<div class="pot-amount">Wins $${pot}</div>`;
                html += '</div>';
                
                createConfetti();
            } else if (result.type === 'split-pot') {
                const share = Math.floor(pot / result.winners.length);
                html += '<div class="winner-announcement">';
                html += '<div class="winner-text">ü§ù SPLIT POT ü§ù</div>';
                html += `<div class="hand-description">${result.winners.map(w => w.name).join(' & ')}</div>`;
                html += `<div class="hand-description">${result.winners[0].handRank.description}</div>`;
                html += `<div class="pot-amount">Each wins $${share}</div>`;
                html += '</div>';
            } else if (result.type === 'fold-win') {
                html += '<div class="winner-announcement">';
                html += '<div class="winner-text">üèÜ WINNER üèÜ</div>';
                html += `<div class="hand-description">${result.winner.name}</div>`;
                html += `<div class="hand-description">All opponents folded</div>`;
                html += `<div class="pot-amount">Wins $${pot}</div>`;
                html += '</div>';
            }
            
            output.innerHTML = html;
        }

        function createConfetti() {
            // Create confetti effect
            const colors = ['#FFD700', '#FFA500', '#FF6347', '#4CAF50', '#2196F3'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * window.innerWidth + 'px';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.3 + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        // Test Cases
        function testCase1() {
            console.log('\n' + '='.repeat(60));
            console.log('TEST CASE 1: Single Winner');
            console.log('='.repeat(60));
            
            const players = [
                createPlayer("Alice", 1000, [
                    createCard('K', 'hearts', 13),
                    createCard('K', 'diamonds', 13),
                    createCard('K', 'spades', 13),
                    createCard('10', 'clubs', 10),
                    createCard('10', 'hearts', 10)
                ]),
                createPlayer("Bob", 1000, [
                    createCard('Q', 'hearts', 12),
                    createCard('Q', 'spades', 12),
                    createCard('A', 'diamonds', 14),
                    createCard('K', 'clubs', 13),
                    createCard('J', 'hearts', 11)
                ]),
                createPlayer("Charlie", 1000, [
                    createCard('A', 'spades', 14),
                    createCard('K', 'diamonds', 13),
                    createCard('Q', 'clubs', 12),
                    createCard('J', 'diamonds', 11),
                    createCard('9', 'hearts', 9)
                ])
            ];
            
            const pot = 450;
            const result = determineWinner(players);
            announceWinner(players, pot, result);
            displayWinnerAnnouncement(players, pot, result);
        }

        function testCase2() {
            console.log('\n' + '='.repeat(60));
            console.log('TEST CASE 2: Split Pot');
            console.log('='.repeat(60));
            
            const players = [
                createPlayer("Alice", 1000, [
                    createCard('A', 'hearts', 14),
                    createCard('A', 'diamonds', 14),
                    createCard('K', 'spades', 13),
                    createCard('Q', 'clubs', 12),
                    createCard('J', 'hearts', 11)
                ]),
                createPlayer("Bob", 1000, [
                    createCard('A', 'spades', 14),
                    createCard('A', 'clubs', 14),
                    createCard('K', 'hearts', 13),
                    createCard('Q', 'diamonds', 12),
                    createCard('J', 'spades', 11)
                ]),
                createPlayer("Charlie", 1000, [
                    createCard('K', 'diamonds', 13),
                    createCard('Q', 'spades', 12),
                    createCard('J', 'clubs', 11),
                    createCard('10', 'hearts', 10),
                    createCard('9', 'diamonds', 9)
                ])
            ];
            
            const pot = 300;
            const result = determineWinner(players);
            announceWinner(players, pot, result);
            displayWinnerAnnouncement(players, pot, result);
        }

        function runExample() {
            console.log('\n' + '='.repeat(60));
            console.log('TEST CASE 3: Win by All Fold');
            console.log('='.repeat(60));
            
            const players = [
                createPlayer("Alice", 1000, [
                    createCard('K', 'hearts', 13),
                    createCard('Q', 'diamonds', 12)
                ]),
                createPlayer("Bob", 1000, [
                    createCard('7', 'spades', 7),
                    createCard('2', 'clubs', 2)
                ], true), // folded
                createPlayer("Charlie", 1000, [
                    createCard('9', 'diamonds', 9),
                    createCard('8', 'hearts', 8)
                ], true) // folded
            ];
            
            const pot = 180;
            const result = determineWinner(players);
            announceWinner(players, pot, result);
            displayWinnerAnnouncement(players, pot, result);
        }

        // Capture console output to debug div
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const debugDiv = document.getElementById('debug');
            debugDiv.textContent += args.join(' ') + '\n';
        };
        
        // Initialize
        console.log('Example 4: Winner Announcement loaded and ready!');
        console.log('Click test cases to see dramatic winner reveals.');
    </script>
</body>
</html>
