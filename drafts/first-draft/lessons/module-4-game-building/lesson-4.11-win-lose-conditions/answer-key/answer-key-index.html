<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Lesson 4.11 Answer Key ‚Äì Win/Lose Conditions</title>
<style>
 body {font-family:Segoe UI, sans-serif; background:#121725; color:#fff; margin:0; padding:20px;}
 .layout {display:grid; grid-template-columns: 320px 1fr 320px; gap:20px;}
 .panel {background:#1e2333; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,.4);}
 h1 {margin:0 0 10px; font-size:1.8rem; color:#FFD700;}
 .stats-list li {margin:4px 0;}
 #overlay {position:fixed; inset:0; background:rgba(0,0,0,.85); display:none; align-items:center; justify-content:center;}
 #overlay.active {display:flex;}
 .modal {background:#20263a; padding:40px 32px; width:420px; border-radius:20px; border:2px solid #FFD700; animation:pop .4s ease;}
 @keyframes pop {0%{transform:scale(.6);opacity:0;}100%{transform:scale(1);opacity:1;}}
 button {cursor:pointer; font-weight:600; border:none; border-radius:8px; padding:10px 18px; margin:6px 6px 0 0;}
 .primary {background:linear-gradient(90deg,#FFD700,#FFA500); color:#000;}
 .secondary {background:#33415c; color:#fff;}
 .badge {display:inline-block; background:#FFD700; color:#000; padding:4px 10px; border-radius:20px; font-size:.75rem; margin:4px 4px 0 0; font-weight:600;}
 .log {height:240px; overflow:auto; font-size:.85rem; background:#0f131d; padding:10px; border-radius:8px;}
 .log-entry {margin:0 0 6px; padding:6px 8px; background:#1e2634; border-left:3px solid #FFD700;}
 .disabled {opacity:.45; pointer-events:none;}
</style>
</head>
<body>
<h1>üèÅ Win / Lose Conditions Demo</h1>
<div class="layout">
  <div class="panel">
    <h2>Session Stats</h2>
    <ul class="stats-list" id="stats"></ul>
    <h3>Achievements</h3>
    <div id="achievements"></div>
  </div>
  <div class="panel">
    <h2>Controls</h2>
    <div id="buttons">
      <button onclick="simulate('player')" class="primary">Simulate Player Win</button>
      <button onclick="simulate('dealer')" class="secondary">Simulate Dealer Win</button>
      <button onclick="simulate('tie')" class="secondary">Simulate Tie</button>
      <button onclick="forceAllIn()" class="secondary">Player All-In</button>
      <button onclick="fastForward()" class="secondary">Fast Forward to End</button>
    </div>
    <h3>Log</h3>
    <div class="log" id="log"></div>
  </div>
  <div class="panel">
    <h2>Chip Counts</h2>
    <p>Player: <span id="pChip">1000</span></p>
    <p>Dealer: <span id="dChip">1000</span></p>
    <p>Pot (demo only): <span id="pot">0</span></p>
  </div>
</div>

<div id="overlay"></div>

<script>
const sessionStats = {
  handsPlayed:0,handsWon:0,handsLost:0,folds:0,allIns:0,biggestPot:0,netChange:0,startingBankroll:1000,currentWinStreak:0,longestWinStreak:0,achievements:[]
};
const gameState = {playerChips:1000,dealerChips:1000,pot:0,gameOver:false,lastHandPlayerAllIn:false,lowestPlayerChips:1000};
const TARGET=2000;
function log(msg){const l=document.getElementById('log');const div=document.createElement('div');div.className='log-entry';div.textContent=msg;l.appendChild(div);l.scrollTop=l.scrollHeight;}
function updateUI(){document.getElementById('pChip').textContent=gameState.playerChips;document.getElementById('dChip').textContent=gameState.dealerChips;document.getElementById('pot').textContent=gameState.pot;document.getElementById('stats').innerHTML=`<li>Hands Played: ${sessionStats.handsPlayed}</li><li>Hands Won: ${sessionStats.handsWon}</li><li>Hands Lost: ${sessionStats.handsLost}</li><li>Win %: ${pct(sessionStats.handsWon, sessionStats.handsPlayed)}</li><li>Folds: ${sessionStats.folds}</li><li>All-Ins: ${sessionStats.allIns}</li><li>Biggest Pot: ${sessionStats.biggestPot}</li><li>Net Change: ${sessionStats.netChange}</li><li>Longest Streak: ${sessionStats.longestWinStreak}</li>`;document.getElementById('achievements').innerHTML=sessionStats.achievements.map(a=>`<span class='badge'>${a.name}</span>`).join('');}
function pct(p,t){return t?((p/t)*100).toFixed(1)+'%':'0%';}
function simulate(winner){if(gameState.gameOver)return; // demo pot
 gameState.pot = Math.floor(Math.random()*300)+50; const potBefore=gameState.pot; if(potBefore>sessionStats.biggestPot)sessionStats.biggestPot=potBefore; sessionStats.handsPlayed++; if(winner==='player'){sessionStats.handsWon++; sessionStats.currentWinStreak++; if(sessionStats.currentWinStreak>sessionStats.longestWinStreak)sessionStats.longestWinStreak=sessionStats.currentWinStreak; gameState.playerChips+=potBefore; log('Player wins '+potBefore);} else if(winner==='dealer'){sessionStats.handsLost++; sessionStats.currentWinStreak=0; gameState.dealerChips+=potBefore; log('Dealer wins '+potBefore);} else {sessionStats.currentWinStreak=0; const half=Math.floor(potBefore/2); gameState.playerChips+=half; gameState.dealerChips+=potBefore-half; log('Tie: split '+potBefore);} sessionStats.netChange=gameState.playerChips-sessionStats.startingBankroll; gameState.pot=0; checkAchievements({lastHandWinner:winner,lastHandPlayerAllIn:gameState.lastHandPlayerAllIn,lowestPlayerChips:gameState.lowestPlayerChips}); checkGameOver(); updateUI();}
function forceAllIn(){if(gameState.gameOver)return; gameState.lastHandPlayerAllIn=true; sessionStats.allIns++; gameState.playerChips=Math.floor(gameState.playerChips/2); log('Player went all-in (demo reduces chips)!'); updateUI();}
function fastForward(){while(!gameState.gameOver && sessionStats.handsPlayed<50){simulate(Math.random()<0.5?'player':'dealer');}}
function checkAchievements(ctx){const a=sessionStats.achievements; const has=id=>a.some(x=>x.id===id); if(!has('first-win')&&sessionStats.handsWon>=1)a.push({id:'first-win',name:'First Win'}); if(!has('streak-3')&&sessionStats.longestWinStreak>=3)a.push({id:'streak-3',name:'3-Win Streak'}); if(!has('all-in-hero')&&ctx.lastHandPlayerAllIn&&ctx.lastHandWinner==='player')a.push({id:'all-in-hero',name:'All-In Hero'}); if(!has('comeback')&&ctx.lowestPlayerChips<300&&ctx.lastHandWinner==='player')a.push({id:'comeback',name:'Comeback'});}
function checkGameOver(){if(gameState.gameOver)return; if(gameState.playerChips<=0)return triggerGameOver('defeat'); if(gameState.dealerChips<=0)return triggerGameOver('victory'); if(gameState.playerChips>=TARGET)return triggerGameOver('victory');}
function triggerGameOver(result){gameState.gameOver=true; log('=== GAME OVER: '+result.toUpperCase()+' ==='); disableButtons(); const o=document.getElementById('overlay'); o.classList.add('active'); const emoji=result==='victory'?'üèÜ':'üíî'; o.innerHTML=`<div class='modal'><h1>${emoji} ${result.toUpperCase()}</h1><p>${result==='victory'?'Great run!':'Every loss teaches a pattern.'}</p><ul style='list-style:none;padding:0;margin:0 0 16px 0;'>
<li>Hands Played: ${sessionStats.handsPlayed}</li>
<li>Win %: ${pct(sessionStats.handsWon, sessionStats.handsPlayed)}</li>
<li>Biggest Pot: ${sessionStats.biggestPot}</li>
<li>Net Change: ${sessionStats.netChange}</li>
<li>Longest Streak: ${sessionStats.longestWinStreak}</li>
</ul><div>${sessionStats.achievements.map(a=>`<span class='badge'>${a.name}</span>`).join('')}</div>
<button class='primary' onclick='resetSession(true)'>Play Again (Full Reset)</button>
<button class='secondary' onclick='resetSession(false)'>Reset Chips (Keep Stats)</button></div>`;}
function disableButtons(){document.getElementById('buttons').classList.add('disabled'); Array.from(document.querySelectorAll('#buttons button')).forEach(b=>b.disabled=true);} function enableButtons(){document.getElementById('buttons').classList.remove('disabled'); Array.from(document.querySelectorAll('#buttons button')).forEach(b=>b.disabled=false);} function resetSession(full){if(full){Object.assign(sessionStats,{handsPlayed:0,handsWon:0,handsLost:0,folds:0,allIns:0,biggestPot:0,netChange:0,currentWinStreak:0,longestWinStreak:0,achievements:[],startingBankroll:1000});} gameState.playerChips=1000; gameState.dealerChips=1000; gameState.gameOver=false; gameState.lastHandPlayerAllIn=false; gameState.lowestPlayerChips=1000; document.getElementById('overlay').classList.remove('active'); enableButtons(); log('Session reset'); updateUI();}
updateUI();
</script>
</body>
</html>